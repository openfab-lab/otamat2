#!/bin/bash

CPPFLAGS=""

# Misc, needed?
CPPFLAGS+=" -Os"
CPPFLAGS+=" -DCORE_DEBUG_LEVEL=ARDUHAL_LOG_LEVEL_DEBUG"

# TFT_eSPI flags as we are using the generic TFT_eSPI, cf TFT_eSPI/User_Setups/Setup25_TTGO_T_Display.h
CPPFLAGS+=" -DUSER_SETUP_LOADED=1"
CPPFLAGS+=" -DUSER_SETUP_ID=25"
CPPFLAGS+=" -DST7789_DRIVER=1"
CPPFLAGS+=" -DTFT_WIDTH=135"
CPPFLAGS+=" -DTFT_HEIGHT=240"
CPPFLAGS+=" -DCGRAM_OFFSET=1"
CPPFLAGS+=" -DTFT_MISO=-1"
CPPFLAGS+=" -DTFT_MOSI=19"
CPPFLAGS+=" -DTFT_SCLK=18"
CPPFLAGS+=" -DTFT_CS=5"
CPPFLAGS+=" -DTFT_DC=16"
CPPFLAGS+=" -DTFT_RST=23"
CPPFLAGS+=" -DTFT_BL=4"
CPPFLAGS+=" -DTFT_BACKLIGHT_ON=1"
CPPFLAGS+=" -DLOAD_GLCD=1"
CPPFLAGS+=" -DLOAD_FONT2=1"
CPPFLAGS+=" -DLOAD_FONT4=1"
CPPFLAGS+=" -DLOAD_FONT6=1"
CPPFLAGS+=" -DLOAD_FONT7=1"
CPPFLAGS+=" -DLOAD_FONT8=1"
CPPFLAGS+=" -DLOAD_GFXFF=1"
CPPFLAGS+=" -DSMOOTH_FONT=1"
CPPFLAGS+=" -DSPI_FREQUENCY=40000000"
CPPFLAGS+=" -DSPI_READ_FREQUENCY=6000000"
# TFT_eSPI flag to avoid warning as there is no touchscreen
CPPFLAGS+=" -DTOUCH_CS=-1"

arduino-cli compile --fqbn esp32:esp32:esp32:PSRAM=disabled,FlashSize=4M --build-property "compiler.cpp.extra_flags=$CPPFLAGS" Otamat2
